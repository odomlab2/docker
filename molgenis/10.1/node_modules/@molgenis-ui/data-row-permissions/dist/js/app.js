(function(t){function e(e){for(var s,r,i=e[0],c=e[1],u=e[2],l=0,d=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);p&&p(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],s=!0,r=1;r<n.length;r++){var i=n[r];0!==a[i]&&(s=!1)}s&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var s={},r={app:0},a={app:0},o=[];function i(t){return c.p+"js/"+({}[t]||t)+".js"}function c(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-50139a16":1,"chunk-8b0dfa98":1};r[t]?e.push(r[t]):0!==r[t]&&n[t]&&e.push(r[t]=new Promise((function(e,n){for(var s="css/"+({}[t]||t)+".css",a=c.p+s,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var u=o[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===s||l===a))return e()}var d=document.getElementsByTagName("style");for(i=0;i<d.length;i++){u=d[i],l=u.getAttribute("data-href");if(l===s||l===a)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var s=e&&e.target&&e.target.src||a,o=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=s,delete r[t],p.parentNode.removeChild(p),n(o)},p.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){r[t]=0})));var s=a[t];if(0!==s)if(s)e.push(s[2]);else{var o=new Promise((function(e,n){s=a[t]=[e,n]}));e.push(s[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var s=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",d.name="ChunkLoadError",d.type=s,d.request=r,n[1](d)}a[t]=void 0}};var p=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=s,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)c.d(n,s,function(e){return t[e]}.bind(null,s));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/@molgenis-ui/data-row-permissions/dist/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var p=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0bb8":function(t,e,n){"use strict";n("3313")},"29fa":function(t,e,n){"use strict";n("5198")},"2c37":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("4d63"),n("ac1f"),n("25f0"),n("4de4"),n("d81d");var s=function(t,e,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!n)return t;var r=new RegExp(n,"i");return t.filter((function(t){return e.map((function(e){return t[e]})).some((function(t){return r.test(t)}))||s.filter((function(t){return r.test(t)})).some((function(e){return t[e]}))}))}},3313:function(t,e,n){},5198:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("ac1f"),n("1276"),n("159b");var s=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"data-row-permissions-plugin"}},[n("router-view")],1)},a=[],o=n("5530"),i=n("2f62"),c=n("31bd"),u={userOptions:[],roleOptions:[],serverError:"",rlsObjects:[],rlsEntities:[],responseStatus:0,permissionObject:{},startInAddMode:!1,availablePermissions:[]},l=(n("caad"),n("2532"),{isSU:function(t){return!(!t.uiContext||!t.uiContext.context)&&t.uiContext.context.roles.includes("ROLE_SU")},isAuthenticated:function(t){return!(!t.uiContext||!t.uiContext.context)&&t.uiContext.context.authenticated},loaded:function(t){return 0!==t.responseStatus}}),d=(n("d81d"),n("b0c0"),n("99af"),{setUserOptions:function(t,e){t.userOptions=e.map((function(t){return{text:t.username,value:t.username}}))},setRoleOptions:function(t,e){t.roleOptions=e.items.map((function(t){return{value:t.data.name,text:"".concat(t.data.label," (").concat(t.data.name,")")}}))},setResponseStatus:function(t,e){t.responseStatus=e.status||200},setPermissionObject:function(t,e){t.permissionObject=e.data},setServerError:function(t,e){t.serverError=e.detail},setStartInAddMode:function(t,e){t.startInAddMode=!e.data.permissions.length&&t.responseStatus<400},setRlsObjects:function(t,e){t.rlsObjects=e.data.objects},setRlsEntities:function(t,e){t.rlsEntities=e.data},setAvailablePermissions:function(t,e){t.availablePermissions=e.data}}),p=n("1da1"),f=(n("96cf"),n("d3b7"),n("ea2f")),m={getAllRoles:function(t){var e=t.commit;f["a"].get("/api/data/sys_sec_Role").then((function(t){e("setRoleOptions",t)})).catch((function(t){e("setResponseStatus",t)}))},getAllUsers:function(t){var e=t.commit;f["a"].get("/api/identities/user").then((function(t){e("setUserOptions",t)})).catch((function(t){e("setResponseStatus",t)}))},getAllPermissionsTypes:function(t){var e=t.commit;e("setResponseStatus",{status:0}),f["a"].get("/api/permissions/types").then((function(t){e("setRlsEntities",t),e("setResponseStatus",t)})).catch((function(t){e("setResponseStatus",t)}))},getPermissionsByEntityId:function(t,e){var n=t.commit;f["a"].get("/api/permissions/types/permissions/".concat(e)).then((function(t){n("setAvailablePermissions",t)})).catch((function(t){n("setResponseStatus",t)}))},getAllRlsObjects:function(t,e){var n=t.commit;n("setResponseStatus",{status:0}),f["a"].get("/api/permissions/".concat(e)).then((function(t){n("setRlsObjects",t),n("setResponseStatus",t)})).catch((function(t){n("setResponseStatus",t)}))},getPermissionsForObject:function(t){var e=t.commit,n=t.state;e("setResponseStatus",{status:0}),f["a"].get("/api/permissions/".concat(n.route.params.entityId,"/").concat(n.route.params.objectId)).then((function(t){e("setPermissionObject",t),e("setResponseStatus",t),e("setStartInAddMode",t)})).catch((function(t){e("setResponseStatus",t)}))},updatePermissions:function(t,e){var n=t.state,s=t.dispatch,r=t.commit;fetch("/api/permissions/".concat(n.route.params.entityId,"/").concat(n.route.params.objectId),{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin",method:"PATCH",body:JSON.stringify(Object(o["a"])({},e))}).then((function(){s("getPermissionsForObject")})).catch((function(t){r("setResponseStatus",t)}))},addPermission:function(t,e){var n=t.state,s=t.commit,r=t.dispatch;f["a"].post("/api/permissions/".concat(n.route.params.entityId,"/").concat(n.route.params.objectId),{body:JSON.stringify({permissions:[e]})}).then((function(){r("getPermissionsForObject")})).catch(function(){var t=Object(p["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.json();case 2:n=t.sent,s("setServerError",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},removePermission:function(t,e){var n=t.dispatch,s=t.state,r=t.commit;f["a"].delete_("/api/permissions/".concat(s.route.params.entityId,"/").concat(s.route.params.objectId),{body:JSON.stringify(e)}).then((function(){n("getPermissionsForObject")})).catch((function(t){r("setResponseStatus",t)}))}},h=n("c54e").default;s["default"].use(i["a"]);var b=new i["a"].Store({state:u,getters:l,mutations:d,actions:m,modules:{uiContext:{namespaced:!0,state:h.store.state,mutations:h.store.mutations,actions:h.store.actions}}}),v=(n("3ca3"),n("ddb0"),n("8c4f")),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-group w-50 mx-auto my-5 "},[n("h3",{staticClass:"mb-4"},[t._v(" "+t._s(t.$t("data-row-permissions-rls-entities"))+" ")]),n("b-form-input",{staticClass:"p-2 mb-2",attrs:{type:"text",placeholder:t.$t("data-row-permissions-filter-placeholder")},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._l(t.results,(function(e){return n("div",{key:e.id},[n("custom-router-link",{attrs:{name:"SelectEntitityObject",params:{entityId:e.id}}},[n("span",[n("font-awesome-icon",{staticClass:"mr-3",attrs:{icon:"folder-open"}}),t._v(t._s(e.label||e.id)+" ")],1),n("font-awesome-icon",{staticClass:"mt-1",attrs:{icon:"angle-right"}})],1)],1)})),n("data-status",{attrs:{items:t.results,loaded:t.loaded}})],2)},y=[],O=(n("841c"),n("2c37")),j=n("f259"),_=n("9946"),w={name:"RlsEntitySelector",components:{DataStatus:j["a"],CustomRouterLink:_["a"]},data:function(){return{search:""}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(i["d"])(["rlsEntities","responseStatus"])),Object(i["c"])(["loaded"])),{},{results:function(){return Object(O["a"])(this.rlsEntities,["entityType","label","id"],this.search)}})},S=w,E=(n("29fa"),n("2877")),x=Object(E["a"])(S,g,y,!1,null,"5b4f702c",null),A=x.exports;s["default"].use(v["a"]);var R="/";window.__INITIAL_STATE__&&(R=window.__INITIAL_STATE__.baseUrl);var C=[{path:"/",name:"SelectEntity",component:A},{path:"/:entityId/",name:"SelectEntitityObject",props:!0,component:function(){return n.e("chunk-8b0dfa98").then(n.bind(null,"645e"))}},{path:"/:entityId/:objectId",name:"DataRowPermissions",props:!0,component:function(){return n.e("chunk-50139a16").then(n.bind(null,"a0fd"))}}],I=new v["a"]({mode:"hash",base:R,routes:C}),P=I,T={data:function(){return{unsync:void 0}},computed:Object(o["a"])({},Object(i["d"])(["serverError"])),watch:{serverError:function(t){this.$bvToast.toast(t,{title:this.$t("data-row-permissions-error"),toaster:"b-toaster-bottom-right",solid:!0,variant:"danger",appendToast:!0,autoHideDelay:6e3})}},beforeCreate:function(){this.unsync=Object(c["sync"])(b,P)},beforeMount:function(){this.fetchContext(),this.getAllUsers(),this.getAllPermissionsTypes()},destroyed:function(){this.unsync()},methods:Object(o["a"])(Object(o["a"])({},Object(i["b"])("uiContext",["fetchContext"])),Object(i["b"])(["getAllUsers","getAllPermissionsTypes"]))},L=T,k=Object(E["a"])(L,r,a,!1,null,null,null),N=k.exports,$=n("6eebe"),M=n("5f5b"),U=(n("2dd8"),n("d6ef"),n("ad3d")),q=n("ecee"),B=n("c074");q["c"].add(B["b"],B["g"],B["f"],B["c"],B["a"],B["e"],B["d"],B["h"]),s["default"].directive("add-class-hover",{bind:function(t,e,n){var s=e.value,r=void 0===s?"":s,a=r.split(" ");t.addEventListener("mouseenter",(function(){a.forEach((function(e){t.classList.add(e)}))})),t.addEventListener("mouseleave",(function(){a.forEach((function(e){t.classList.remove(e)}))}))},unbind:function(t,e,n){t.removeEventListener("mouseenter",n),t.removeEventListener("mouseleave",n)}}),s["default"].use(M["a"]),s["default"].component("font-awesome-icon",U["a"]),s["default"].config.productionTip=!1,s["default"].use($["a"],{lng:window.__INITIAL_STATE__.lng||"en",fallbackLng:window.__INITIAL_STATE__.fallbackLng||"en",namespace:["data-row-permissions"],callback:function(){new s["default"]({router:P,store:b,render:function(t){return t(N)}}).$mount("#app")}})},9946:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-link",{directives:[{name:"add-class-hover",rawName:"v-add-class-hover",value:"bg-primary text-white",expression:"'bg-primary text-white'"}],staticClass:"list-group-item d-flex justify-content-between",attrs:{to:{name:t.name,params:t.params}}},[t._t("default")],2)},r=[],a={props:{params:{type:Object,required:!1,default:function(){}},name:{type:String,required:!0}}},o=a,i=n("2877"),c=Object(i["a"])(o,s,r,!1,null,null,null);e["a"]=c.exports},d6ef:function(t,e,n){},f259:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return 0===t.results.length?n("div",[n("div",{staticClass:"align-center-container"},[t.resultsLoaded?t.isAuthenticated?n("span",{staticClass:"mt-2"},[t._v(t._s(t.$t("data-row-permissions-no-results")))]):n("span",{staticClass:"mt-2"},[t._v(t._s(t.$t("data-row-permissions-no-results-cta"))+" "),n("a",{attrs:{href:"/login"}},[t._v(t._s(t.$t("data-row-permissions-cta-login")))]),t._v(".")]):n("div",{staticClass:"align-center text-center "},[n("b-spinner",{attrs:{label:"Spinning",variant:"primary"}}),n("div",{staticClass:"mt-5"},[t._v(" "+t._s(t.$t("data-row-permissions-spinner-text"))+" ")])],1)])]):t._e()},r=[],a=n("5530"),o=n("2f62"),i={props:{items:{type:Array,required:!0},loaded:{type:Boolean,required:!0}},computed:Object(a["a"])(Object(a["a"])({},Object(o["c"])(["isAuthenticated"])),{},{results:function(){return this.items},resultsLoaded:function(){return this.loaded}})},c=i,u=(n("0bb8"),n("2877")),l=Object(u["a"])(c,s,r,!1,null,"2cd223c0",null);e["a"]=l.exports}});
//# sourceMappingURL=app.js.map