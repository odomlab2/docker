/*!
 * package-name: @molgenis-ui/scripts
 * package-version: 3.2.0
 * build-date: Thu, 15 Apr 2021 07:35:59 GMT
 */(function(e){function t(t){for(var r,i,o=t[0],c=t[1],l=t[2],f=0,d=[];f<o.length;f++)i=o[f],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&d.push(s[i][0]),s[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},s={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/@molgenis-ui/scripts/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"08ab":function(e,t,n){"use strict";n("5c47")},"0fb9":function(e,t,n){},"430f":function(e,t,n){"use strict";n("9eab")},4678:function(e,t,n){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}s.keys=function(){return Object.keys(r)},s.resolve=a,e.exports=s,s.id="4678"},"5c47":function(e,t,n){},"9eab":function(e,t,n){},a114:function(e,t,n){"use strict";n("0fb9")},cd49:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.showError?n("b-alert",{attrs:{variant:"danger",show:"",dismissible:""}},[e._v("\n    "+e._s(e._f("i18n")("scripts-connection-error"))+"\n    "),n("router-link",{attrs:{to:"/login",tag:"button"}},[e._v("Sign in")])],1):e._e(),e.showError?e._e():n("router-view")],1)},a=[],i=(n("9463"),{name:"App",data:function(){return{showError:!1}},created:function(){var e=this;this.$store.dispatch("requestScripts").catch((function(){e.showError=!0}))}}),o=i,c=n("2877"),l=Object(c["a"])(o,s,a,!1,null,null,null),u=l.exports,f=n("8c4f"),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"navigator-actions"},[n("b-button",{staticClass:"mb-3",attrs:{size:"sm",variant:"primary",title:e._f("i18n")("scripts-add-new-script")},on:{click:e.createNewScript}},[n("font-awesome-icon",{attrs:{icon:"plus",size:"lg"}}),e._v(" "+e._s(e._f("i18n")("scripts-new-script")))],1)],1),n("b-modal",{attrs:{id:"removeScriptModal",title:e._f("i18n")("scripts-confirm-deletion"),"ok-title":e._f("i18n")("scripts-delete-label"),"ok-variant":"danger"},on:{ok:e.confirmedRemove},model:{value:e.showRemoveModal,callback:function(t){e.showRemoveModal=t},expression:"showRemoveModal"}},[n("p",{staticClass:"my-4"},[e._v(e._s(e._f("i18n")("scripts-remove-script")))])]),n("b-table",{staticClass:"text-left",attrs:{hover:!0,items:e.scripts.items,fields:e.fields,filter:e.filter,"show-empty":""},on:{"row-clicked":e.editScript},scopedSlots:e._u([{key:"cell(edit)",fn:function(t){return[n("b-button",{staticClass:"editButton",attrs:{name:t.item.name,size:"sm",variant:"primary",title:e._f("i18n")("scripts-edit-script")},on:{click:function(n){return e.editScript({name:t.item.name})}}},[n("font-awesome-icon",{attrs:{icon:"edit",size:"lg"}})],1)]}},{key:"cell(remove)",fn:function(t){return[n("b-button",{staticClass:"removeButton",attrs:{name:t.item.name,size:"sm",variant:"danger",title:e._f("i18n")("scripts-delete-script")},on:{click:function(n){return e.doOpenModal(t.item.name)}}},[n("font-awesome-icon",{attrs:{icon:"trash",size:"lg"}})],1)]}},{key:"cell(name)",fn:function(t){return[e._v("\n      "+e._s(t.item.name)+" "),n("b-badge",[e._v(e._s(t.item.type.name)+" ")])]}},{key:"cell(parameters)",fn:function(t){return e._l(t.item.parameters,(function(t,r){return n("span",{key:"parameter-"+r},[0!=r?n("span",[e._v(",")]):e._e(),e._v(" "+e._s(t.name))])}))}},{key:"cell(execute)",fn:function(t){return[e.loaded?n("ExecuteButton",{attrs:{size:"sm",parameters:e.simpleParameters(t.item.parameters),name:t.item.name,title:e._f("i18n")("scripts-run-script")}},[e._v(e._s(e._f("i18n")("scripts-run-label")))]):e._e()]}}])})],1)},m=[],p=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("bd86")),b=n("2f62"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.loaded?n("span",{attrs:{name:e.name}},[n("b-button",{staticClass:"runButton",attrs:{disabled:e.disabled,size:e.size,variant:"primary"},on:{click:function(t){return t.stopPropagation(),e.execute(t)}}},[n("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:"play",size:"lg"}}),e._t("default")],2),n("RunModal",{attrs:{parameters:e.parameters,name:e.name},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}})],1):e._e()},v=[],j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:function(e){e.stopPropagation()}}},[n("b-modal",{ref:"modal-"+e.name,attrs:{title:e._f("i18n")("scripts-parameters-label"),"ok-title":e._f("i18n")("scripts-run-label")},on:{ok:e.run},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},e._l(e.parameters,(function(t,r){return n("div",{key:"modal-parameter-"+r,staticClass:"mb-1"},[n("label",{staticClass:"mb-1",attrs:{for:t}},[e._v(e._s(t))]),n("b-form-input",{staticClass:"mb-1",attrs:{id:t,type:"text"},model:{value:e.values[r],callback:function(t){e.$set(e.values,r,t)},expression:"values[index]"}})],1)})),0)])],1)},_=[],y={props:["parameters","name","value"],name:"RunModal",data:function(){return{values:[],showModal:this.value}},watch:{showModal:function(e){this.$emit("input",e)},value:function(e){this.showModal=e}},methods:{run:function(){var e=this;this.showModal=!1;var t=this.parameters.reduce((function(t,n,r){return t+encodeURIComponent(n)+"="+encodeURIComponent(e.values[r])+"&"}),"/scripts/"+this.name+"/start?");window.open(t,"_blank")}}},g=y,w=(n("08ab"),Object(c["a"])(g,j,_,!1,null,"1fbca280",null)),k=w.exports;function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(p["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={name:"ExecuteButton",props:{parameters:Array,name:String,form:Object,size:{type:String,default:""},disabled:{type:Boolean,default:!1},doSave:{type:Boolean,default:!1}},data:function(){return{showModal:!1,save:!1}},computed:S({},Object(b["b"])(["loaded"])),components:{RunModal:k},methods:{execute:function(){var e=this;this.doSave?this.$store.dispatch("saveParametersAndScripts",this.form).then((function(){e.run()})):this.run()},run:function(){this.parameters.length>0?this.showModal=!0:window.open("/scripts/"+this.name+"/start","_blank")}}},x=E,P=Object(c["a"])(x,h,v,!1,null,null,null),C=P.exports;function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){Object(p["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=r["default"].extend({name:"ScriptList",data:function(){return{fields:[{key:"edit",label:"",class:"compact align-middle"},{key:"remove",label:"",class:"compact align-middle"},{key:"name",label:"scripts-name-label"|this.i18n,sortable:!0,class:"align-middle"},{key:"parameters",label:"scripts-parameters-label"|this.i18n,sortable:!1,class:"align-middle"},{key:"resultFileExtension",label:"scripts-result-file-extension"|this.i18n,sortable:!1,class:"compact align-middle"},{key:"execute",label:"",sortable:!1,class:"compact"}],hover:!0,showRemoveModal:!1,confirmedToRemove:"",filter:null}},computed:z({},Object(b["b"])(["scripts","loaded"])),components:{ExecuteButton:C},methods:{editScript:function(e){this.$router.push({name:"editscript",params:{id:e.name}})},simpleParameters:function(e){return e.map((function(e){return e.name}))},doOpenModal:function(e){this.confirmedToRemove=e,this.showRemoveModal=!this.showRemoveModal},confirmedRemove:function(){this.$store.dispatch("removeScript",this.confirmedToRemove),this.confirmedToRemove=""},createNewScript:function(){this.$router.push({name:"newscript"})}}}),D=$,M=(n("a114"),Object(c["a"])(D,d,m,!1,null,"479d5ba5",null)),F=M.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e.showValidationError?n("b-alert",{attrs:{variant:"danger",show:"",dismissible:""}},[e._v("\n    "+e._s(e._f("i18n")("scripts-save-error"))+"\n  ")]):e._e(),n("h1",[e._v(e._s(e.form.name))]),e.loaded?n("CodeEditor",{attrs:{initialData:e.form.content,scriptType:e.form.type},on:{valueChange:e.onValueChange}},[n("ExecuteButton",{attrs:{disabled:!e.contentValidation,doSave:!0,form:e.form,size:"sm",parameters:e.form.parameters,name:e.form.name}},[e._v(e._s(e._f("i18n")("scripts-save-and-run")))])],1):e._e(),n("b-row",{staticClass:"mb-3"},[n("b-col",{staticClass:"border-right",attrs:{sm:"4"}},[n("label",[e._v(e._s(e._f("i18n")("scripts-type-label")))]),n("b-form-select",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.scriptTypes,(function(t,r){return n("option",{key:"type-"+r,domProps:{value:t}},[e._v(e._s(t))])})),0)],1),n("b-col",{staticClass:"border-right",attrs:{sm:"4"}},[n("label",[e._v(e._s(e._f("i18n")("scripts-result-file-extension")))]),n("b-form-input",{attrs:{id:"fileExtension",type:"text",placeholder:""},model:{value:e.form.resultFileExtension,callback:function(t){e.$set(e.form,"resultFileExtension",t)},expression:"form.resultFileExtension"}})],1),n("b-col",{attrs:{sm:"4"}},[n("label",{staticClass:"mb-3"},[e._v(e._s(e._f("i18n")("scripts-generate-security-token")))]),n("b-form-radio-group",{attrs:{id:"generateToken",name:"generateToken"},model:{value:e.form.generateToken,callback:function(t){e.$set(e.form,"generateToken",t)},expression:"form.generateToken"}},[n("b-form-radio",{attrs:{value:!0}},[e._v(e._s(e._f("i18n")("scripts-true-label")))]),n("b-form-radio",{attrs:{value:!1}},[e._v(e._s(e._f("i18n")("scripts-false-label")))])],1),e.form.generateToken?n("small",[e._v(e._s(e._f("i18n")("scripts-please-use"))+": "),n("code",[e._v("${molgenisToken}")])]):e._e()],1)],1),n("div",{staticClass:"mb-4"},[n("button",{staticClass:"btn btn-secondary mr-3",attrs:{id:"cancel-btn",type:"reset"},on:{click:function(t){return t.preventDefault(),e.onCancel(t)}}},[e._v(e._s(e._f("i18n")("scripts-cancel-label")))]),n("button",{staticClass:"btn btn-primary mr-3",attrs:{disabled:!e.contentValidation,id:"save-btn",type:"button"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v(e._s(e._f("i18n")("scripts-save-label")))])])],1)},R=[],A=(n("7514"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"position-relative"},[e.showField?n("form-component",{class:(e.codeEditorState.$valid||e.codeEditorState.$untouched)&&"border",attrs:{id:"CodeEditor",formFields:e.codeEditorFields,initialFormData:e.codeEditorData,formState:e.codeEditorState,options:e.options},on:{valueChange:e.onValueChanged}}):e._e(),n("span",{staticClass:"in-corner"},[e._t("default")],2)],1),n("div",{staticClass:"mb-3"},[e.parameters.length>0?n("small",[e._v(e._s(e._f("i18n")("scripts-exposed-parameters"))+"\n      "),e._l(e.parameters,(function(t,r){return n("b-badge",{key:"type-"+r,staticClass:"mr-1",attrs:{variant:"molgenisToken"==t||"outputFile"==t?"secondary":"primary"}},[e._v(e._s(t))])}))],2):e._e()])])}),N=[],q=n("6004"),B=(n("6762"),n("2fdb"),/\${([\w-#]+)}/g),I=/\$\(\"([\w-#]+)\"\)|\$\(\'([\w-#]+)\'\)/g,L=/[a-zA-Z]/,U=function(e){return!["login","logout","csv","base","exist","meta","_idValue"].includes(e)},J=function(e){return L.test(e.charAt(0))},Z=function(e,t){var n,r=[];while(null!==(n=t.exec(e)))r.push(n[1]||n[2]);return r},G=function(e,t){var n="JavaScript (Magma)"===t?I:B,r=Z(e,n),s=r.filter(U).filter(J);return s},H={name:"CodeEditor",props:{initialData:String,scriptType:String},data:function(){return{showField:!0,options:{showEyeButton:!1,allowAddingOptions:!1},codeEditorFields:[{type:"script",id:"content",label:"",description:null,required:function(){return!0},disabled:!1,readOnly:!1,visible:function(){return!0},validate:function(){return!0}}],codeEditorData:{content:""},codeEditorState:{}}},computed:{parameters:function(){var e=G(this.codeEditorData.content,this.scriptType);return e=e.filter((function(e,t,n){return n.indexOf(e)===t})),this.$emit("valueChange",{parameters:e,content:this.codeEditorData.content}),e}},methods:{onValueChanged:function(e){this.codeEditorData=e}},created:function(){this.initialData&&(this.codeEditorData.content=this.initialData)},components:{FormComponent:q["FormComponent"]}},K=H,Q=(n("430f"),Object(c["a"])(K,A,N,!1,null,"2393ffde",null)),W=Q.exports;function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Object(p["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee={name:"EditScript",data:function(){return{id:0,showValidationError:!1,form:{name:"",type:"",generateToken:"false",resultFileExtension:"",content:"",parameters:[]}}},computed:Y(Y({},Object(b["b"])(["scriptTypes","scripts","loaded"])),{},{contentValidation:function(){return this.form.content.length>0}}),watch:{scripts:function(e){this.updateForm(e)}},methods:{updateForm:function(e){var t=this;if(e.hasOwnProperty("items")){var n=[];e.items.length>0&&(n=e.items.find((function(e){return e.name===t.id}))),this.form.name=n.name,this.form.type=n.type.name,this.form.generateToken=n.generateToken,this.form.resultFileExtension=n.resultFileExtension,this.form.content=n.content,this.form.parameters=n.parameters.map((function(e){return e.name}))}},onSubmit:function(){var e=this;this.$store.dispatch("saveParametersAndScripts",this.form).then((function(){e.$router.push({name:"scripts"})}),(function(t){e.onError(t)}))},onError:function(){this.showValidationError=!0},onCancel:function(){this.$router.push({name:"scripts"})},onValueChange:function(e){var t=e.parameters,n=e.content;this.form.parameters=t,this.form.content=n}},created:function(){this.id=this.$route.params.id,this.updateForm(this.scripts)},components:{CodeEditor:W,ExecuteButton:C}},te=ee,ne=Object(c["a"])(te,V,R,!1,null,null,null),re=ne.exports,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e.showValidationError?n("b-alert",{attrs:{variant:"danger",show:"",dismissible:""}},[e._v("\n    "+e._s(e._f("i18n")("scripts-save-error"))+"\n  ")]):e._e(),n("b-row",{staticClass:"mb-3"},[n("b-col",{attrs:{sm:"9"}},[n("label",[e._v(e._s(e._f("i18n")("scripts-name-label"))+" *")]),n("b-form-input",{attrs:{state:e.nameValidation,id:"name",type:"text"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),n("b-form-invalid-feedback",{attrs:{state:e.nameValidation}},[e._v("\n        "+e._s(e._f("i18n")("scripts-unique-error"))+"\n      ")])],1),n("b-col",{attrs:{sm:"3"}},[n("label",[e._v(e._s(e._f("i18n")("scripts-type-label")))]),n("b-form-select",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.scriptTypes,(function(t,r){return n("option",{key:"type-"+r,domProps:{value:t}},[e._v(e._s(t))])})),0)],1)],1),n("CodeEditor",{attrs:{scriptType:e.form.type},on:{valueChange:e.onValueChange}}),n("b-row",{staticClass:"mb-3"},[n("b-col",{staticClass:"border-right",attrs:{sm:"4"}},[n("label",[e._v(e._s(e._f("i18n")("scripts-result-file-extension")))]),n("b-form-input",{attrs:{id:"fileExtension",type:"text",placeholder:""},model:{value:e.form.resultFileExtension,callback:function(t){e.$set(e.form,"resultFileExtension",t)},expression:"form.resultFileExtension"}})],1),n("b-col",{attrs:{sm:"4"}},[n("label",{staticClass:"mb-3"},[e._v(e._s(e._f("i18n")("scripts-generate-security-token")))]),n("b-form-radio-group",{attrs:{id:"generateToken",name:"generateToken"},model:{value:e.form.generateToken,callback:function(t){e.$set(e.form,"generateToken",t)},expression:"form.generateToken"}},[n("b-form-radio",{attrs:{value:"true"}},[e._v(e._s(e._f("i18n")("scripts-true-label")))]),n("b-form-radio",{attrs:{value:"false"}},[e._v(e._s(e._f("i18n")("scripts-false-label")))])],1),"true"==e.form.generateToken?n("small",[e._v(e._s(e._f("i18n")("scripts-please-use"))+": "),n("code",[e._v("${molgenisToken}")])]):e._e()],1),n("b-col",{attrs:{sm:"4"}})],1),n("div",{staticClass:"mb-4"},[n("button",{staticClass:"btn btn-secondary mr-3",attrs:{id:"cancel-btn",type:"reset"},on:{click:function(t){return t.preventDefault(),e.onCancel(t)}}},[e._v(e._s(e._f("i18n")("scripts-cancel-label")))]),n("button",{staticClass:"btn btn-primary",attrs:{disabled:!e.nameValidation||!e.contentValidation,id:"save-btn",type:"button"},on:{click:function(t){return t.preventDefault(),e.onSubmit(t)}}},[e._v(e._s(e._f("i18n")("scripts-save-label")))])])],1)},ae=[];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){Object(p["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce={name:"NewScript",data:function(){return{showValidationError:!1,nameChanged:!1,form:{name:"",type:"",generateToken:"false",resultFileExtension:"",content:"",parameters:[]}}},computed:oe(oe({},Object(b["b"])(["scriptTypes","scripts","loaded"])),{},{nameValidation:function(){return this.nameChanged?this.form.name.length>0&&this.isUniqueName:null},contentValidation:function(){return this.form.content.length>0},formName:function(){return this.form.name},isUniqueName:function(){var e=this;return!this.loaded||!this.scripts.items.some((function(t){return e.form.name===t.name}))}}),watch:{formName:function(){this.nameChanged=!0},scriptTypes:function(e){this.form.type=e[0]}},methods:{onSubmit:function(){var e=this;this.nameChanged=!0,this.nameValidation&&""!==this.form.name&&this.$store.dispatch("newParametersAndScripts",this.form).then((function(){e.$router.push({name:"scripts"})}),(function(t){e.onError(t)}))},onError:function(){this.showValidationError=!0},onCancel:function(){this.$router.push({name:"scripts"})},onValueChange:function(e){var t=e.parameters,n=e.content;this.form.parameters=t,this.form.content=n}},created:function(){this.form.type=this.scriptTypes[0]},components:{CodeEditor:W}},le=ce,ue=Object(c["a"])(le,se,ae,!1,null,null,null),fe=ue.exports;r["default"].use(f["a"]);var de=new f["a"]({mode:"history",base:window.__INITIAL_STATE__.baseUrl||"/",routes:[{path:"/",name:"scripts",component:F},{path:"/add/",name:"newscript",component:fe},{path:"/edit/:id",name:"editscript",component:re}]}),me={scripts:[],scriptTypes:[],loaded:!1},pe=me,be=n("ea2f"),he={requestScripts:function(e){e.dispatch;var t=e.commit;return new Promise((function(e,n){be["a"].get("/api/v2/sys_scr_ScriptType?num=10000").then((function(e){t("loadScriptTypes",e.items.map((function(e){return e.name})))})),be["a"].get("/api/v2/sys_scr_Script?num=10000").then((function(n){t("loadScripts",n),t("setLoadedState",!0),e()}),(function(e){n(e)}))}))},editScript:function(e,t){var n=e.dispatch;e.commit;return new Promise((function(e,r){["molgenisToken","outputFile"].map((function(e){t.parameters=t.parameters.filter((function(t){return t!==e}))}));var s={body:JSON.stringify({entities:[t]})};be["a"].put("/api/v2/sys_scr_Script",s).then((function(t){n("requestScripts"),e()}),(function(e){r(e)}))}))},newScript:function(e,t){var n=e.dispatch;e.commit;return new Promise((function(e,r){["molgenisToken","outputFile"].map((function(e){t.parameters=t.parameters.filter((function(t){return t!==e}))}));var s={body:JSON.stringify({entities:[t]})};be["a"].post("/api/v2/sys_scr_Script",s).then((function(t){n("requestScripts"),e()}),(function(e){r(e)}))}))},removeScript:function(e,t){var n=e.dispatch;e.commit;be["a"].delete_("/api/v2/sys_scr_Script/"+t).then((function(e){n("requestScripts")}),(function(){}))},saveParametersAndScripts:function(e,t){var n=e.dispatch;e.commit;return new Promise((function(e,r){n("addParameters",t.parameters).then((function(){n("editScript",t).then((function(){e()}),(function(e){r(e)}))}),(function(e){r(e)}))}))},newParametersAndScripts:function(e,t){var n=e.dispatch;e.commit;return new Promise((function(e,r){n("addParameters",t.parameters).then((function(){n("newScript",t).then((function(){e()}),(function(e){r(e)}))}),(function(e){r(e)}))}))},addParameters:function(e,t){e.dispatch,e.commit;return new Promise((function(e,n){be["a"].get("/api/v2/sys_scr_ScriptParameter?num=10000").then((function(r){var s=r.items.map((function(e){return e.name}));if(s.push("molgenisToken"),s.push("outputFile"),s.map((function(e){t=t.filter((function(t){return t!==e}))})),t.length>0){var a={body:JSON.stringify({entities:t.map((function(e){return{name:e}}))})};be["a"].post("/api/v2/sys_scr_ScriptParameter",a).then((function(t){e()}),(function(e){n(e)}))}else e()}),(function(e){n(e)}))}))}},ve={loadScripts:function(e,t){e.scripts=t},loadScriptTypes:function(e,t){e.scriptTypes=t},setLoadedState:function(e,t){e.loaded=t}};r["default"].use(b["a"]);var je=new b["a"].Store({state:pe,mutations:ve,actions:he}),_e=n("5f5b"),ye=n("6eeb"),ge=n("ecee"),we=n("c074"),ke=n("ad3d");r["default"].config.productionTip=!1,ge["c"].add(we["a"],we["d"],we["b"],we["c"]),r["default"].component("font-awesome-icon",ke["a"]),r["default"].use(_e["a"]),r["default"].use(ye["a"],{lng:window.__INITIAL_STATE__.lng||"en",fallbackLng:window.__INITIAL_STATE__.fallbackLng||"en",namespace:["scripts"],callback:function(){new r["default"]({router:de,store:je,render:function(e){return e(u)}}).$mount("#molgenis-scripts")}})}});
//# sourceMappingURL=app.js.map